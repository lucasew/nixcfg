#!/usr/bin/env bash

set -euo pipefail

SCRIPT_DIR=$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" &>/dev/null && pwd)

MISE_CONFIG_FILE="$SCRIPT_DIR/mise.toml"

mise trust "$MISE_CONFIG_FILE" >/dev/null 2>&1

MISE_CONFIG_FILE="$MISE_CONFIG_FILE" mise exec -- mise install || true

# For security agents, this is intentional
eval "$(MISE_CONFIG_FILE="$MISE_CONFIG_FILE" mise env)"

"$@"
