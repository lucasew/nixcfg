{{- /* Generate 'x' shim first */ -}}
{{- file "x" "0755" }}
#!/usr/bin/env bash
export PATH="{{ userDataDir }}/shim/lazy:$PATH"
exec "$@"
{{- endfile }}

{{- /* Generate global shims for tools marked as global */ -}}
{{- range $name, $tool := .LazyTools }}
{{- if $tool.Global }}
{{- $bins := $tool.Bins }}
{{- if eq (len $bins) 0 }}
  {{- $binName := $tool.Alias }}
  {{- if not $binName }}
    {{- /* Clean up name (e.g. github:owner/repo -> repo) */}}
    {{- $parts := split $name ":" }}
    {{- $binName = last $parts }}
    {{- $parts = split $binName "/" }}
    {{- $binName = last $parts }}
  {{- end }}
  {{- $bins = list $binName }}
{{- end }}
{{- range $bins }}
{{- file . "0755" }}
#!/usr/bin/env bash
exec x {{ . }} "$@"
{{- endfile }}
{{- end }}
{{- end }}
{{- end }}
